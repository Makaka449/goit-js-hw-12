{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  nav: true,\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 150,\n});\n\nconst form = document.querySelector('.search-form');\nconst container = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-btn');\nlet searchWord = '';\nlet currPage;\n\nform.addEventListener('submit', onSubmit);\nloadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onSubmit(event) {\n  currPage = 1;\n  event.preventDefault();\n  container.innerHTML = '';\n  searchWord = form.elements.searchWord.value.trim();\n  loadMoreBtn.style.display = 'block';\n\n  if (searchWord === '') {\n    showEmptyInputMessage();\n    container.innerHTML = '';\n    loadMoreBtn.style.display = 'none';\n    form.reset();\n    return;\n  }\n  loader.style.display = 'block';\n\n  try {\n    const images = await fetchImages(searchWord, currPage).then(data => {\n      const marcup = renderMarcup(data);\n      if (data.hits.length === 0) {\n        noImagesMessage();\n        loadMoreBtn.style.display = 'none';\n        loader.style.display = 'none';\n        return;\n      }\n      container.insertAdjacentHTML('beforeend', marcup);\n      lightbox.refresh();\n      loader.style.display = 'none';\n    });\n  } catch (error) {\n    console.error('Error:', error);\n  }\n  form.reset();\n}\n\nasync function onLoadMore() {\n  currPage += 1;\n  try {\n    const images = await fetchImages(searchWord, currPage).then(data => {\n      const marcup = renderMarcup(data);\n      container.insertAdjacentHTML('beforeend', marcup);\n      lightbox.refresh();\n\n      const cardHeight = container.getBoundingClientRect().height;\n      window.scrollBy({\n        top: 2 * cardHeight,\n        behavior: 'smooth',\n      });\n\n      if (data.hits.length <= 14) {\n        loadMoreBtn.style.display = 'none';\n        showEndOfListMessage();\n        lightbox.refresh();\n      }\n    });\n  } catch (error) {\n    console.error('Error:', error);\n  }\n}\n\nexport async function fetchImages(searchWord, currPage) {\n  const KEY = '43280076-efaf032a147c4a401dc5ab87e';\n  const URL = 'https://pixabay.com/api/';\n  const resp = await axios.get(URL, {\n    params: {\n      key: KEY,\n      q: searchWord,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: currPage,\n      per_page: 15,\n    },\n  });\n  return resp.data;\n}\n\nfunction renderMarcup(data) {\n  return data.hits\n    .map(\n      el =>\n        `<div class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${el.largeImageURL}\">\n                <img class=\"gallery-image\" src=\"${el.webformatURL}\" alt=\"${el.tags}\" />\n            </a>\n            <div class=\"gallery-item-info\">\n                <p class=\"gallery-item-info-par\">\n                    <span class=\"gallery-item-info-span\">Likes: <span>${el.likes}</span>\n                    </span>\n                </p>\n                <p class=\"gallery-item-info-par\">\n                    <span class=\"gallery-item-info-span\">Views: <span>${el.views}</span>\n                    </span>\n                </p>\n                <p class=\"gallery-item-info-par\">\n                    <span class=\"gallery-item-info-span\">Comments: <span>${el.comments}</span>\n                    </span>\n                </p>\n                <p class=\"gallery-item-info-par\">\n                    <span class=\"gallery-item-info-span\">Downloads: <span>${el.downloads}</span>\n                    </span>\n                </p>\n            </div>\n        </div>`\n    )\n    .join('');\n}\n\nfunction showEndOfListMessage() {\n  iziToast.info({\n    timeout: 3000,\n    position: 'topRight',\n    message: \"We're sorry, but you've reached the end of search results.\",\n  });\n}\n\nfunction showEmptyInputMessage() {\n  iziToast.info({\n    timeout: 3000,\n    position: 'topRight',\n    message: \"The search query can not be empty!\",\n  });\n}\n\nfunction noImagesMessage() {\n  iziToast.error({\n    timeout: 3000,\n    position: 'topRight',\n    message:\n      'There are no images matching your search query. Please, enter something else!',\n  });\n}\n\n"],"names":["lightbox","SimpleLightbox","form","container","loader","loadMoreBtn","searchWord","currPage","onSubmit","onLoadMore","event","showEmptyInputMessage","images","fetchImages","data","marcup","renderMarcup","noImagesMessage","error","cardHeight","showEndOfListMessage","KEY","URL","axios","el","iziToast"],"mappings":"owBAMA,MAAMA,EAAW,IAAIC,EAAe,aAAc,CAChD,IAAK,GACL,SAAU,GACV,aAAc,MACd,aAAc,GAChB,CAAC,EAEKC,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAY,SAAS,cAAc,UAAU,EAC7CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,WAAW,EACtD,IAAIC,EAAa,GACbC,EAEJL,EAAK,iBAAiB,SAAUM,CAAQ,EACxCH,EAAY,iBAAiB,QAASI,CAAU,EAEhD,eAAeD,EAASE,EAAO,CAO7B,GANAH,EAAW,EACXG,EAAM,eAAc,EACpBP,EAAU,UAAY,GACtBG,EAAaJ,EAAK,SAAS,WAAW,MAAM,KAAI,EAChDG,EAAY,MAAM,QAAU,QAExBC,IAAe,GAAI,CACrBK,IACAR,EAAU,UAAY,GACtBE,EAAY,MAAM,QAAU,OAC5BH,EAAK,MAAK,EACV,MACD,CACDE,EAAO,MAAM,QAAU,QAEvB,GAAI,CACF,MAAMQ,EAAS,MAAMC,EAAYP,EAAYC,CAAQ,EAAE,KAAKO,GAAQ,CAClE,MAAMC,EAASC,EAAaF,CAAI,EAChC,GAAIA,EAAK,KAAK,SAAW,EAAG,CAC1BG,IACAZ,EAAY,MAAM,QAAU,OAC5BD,EAAO,MAAM,QAAU,OACvB,MACD,CACDD,EAAU,mBAAmB,YAAaY,CAAM,EAChDf,EAAS,QAAO,EAChBI,EAAO,MAAM,QAAU,MAC7B,CAAK,CACF,OAAQc,EAAO,CACd,QAAQ,MAAM,SAAUA,CAAK,CAC9B,CACDhB,EAAK,MAAK,CACZ,CAEA,eAAeO,GAAa,CAC1BF,GAAY,EACZ,GAAI,CACF,MAAMK,EAAS,MAAMC,EAAYP,EAAYC,CAAQ,EAAE,KAAKO,GAAQ,CAClE,MAAMC,EAASC,EAAaF,CAAI,EAChCX,EAAU,mBAAmB,YAAaY,CAAM,EAChDf,EAAS,QAAO,EAEhB,MAAMmB,EAAahB,EAAU,sBAAqB,EAAG,OACrD,OAAO,SAAS,CACd,IAAK,EAAIgB,EACT,SAAU,QAClB,CAAO,EAEGL,EAAK,KAAK,QAAU,KACtBT,EAAY,MAAM,QAAU,OAC5Be,IACApB,EAAS,QAAO,EAExB,CAAK,CACF,OAAQkB,EAAO,CACd,QAAQ,MAAM,SAAUA,CAAK,CAC9B,CACH,CAEO,eAAeL,EAAYP,EAAYC,EAAU,CACtD,MAAMc,EAAM,qCACNC,EAAM,2BAYZ,OAXa,MAAMC,EAAM,IAAID,EAAK,CAChC,OAAQ,CACN,IAAKD,EACL,EAAGf,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAU,EACX,CACL,CAAG,GACW,IACd,CAEA,SAASS,EAAaF,EAAM,CAC1B,OAAOA,EAAK,KACT,IACCU,GACE;AAAA,4CACoCA,EAAG,aAAa;AAAA,kDACVA,EAAG,YAAY,UAAUA,EAAG,IAAI;AAAA;AAAA;AAAA;AAAA,wEAIVA,EAAG,KAAK;AAAA;AAAA;AAAA;AAAA,wEAIRA,EAAG,KAAK;AAAA;AAAA;AAAA;AAAA,2EAILA,EAAG,QAAQ;AAAA;AAAA;AAAA;AAAA,4EAIVA,EAAG,SAAS;AAAA;AAAA;AAAA;AAAA,eAKnF,EACA,KAAK,EAAE,CACZ,CAEA,SAASJ,GAAuB,CAC9BK,EAAS,KAAK,CACZ,QAAS,IACT,SAAU,WACV,QAAS,4DACb,CAAG,CACH,CAEA,SAASd,GAAwB,CAC/Bc,EAAS,KAAK,CACZ,QAAS,IACT,SAAU,WACV,QAAS,oCACb,CAAG,CACH,CAEA,SAASR,GAAkB,CACzBQ,EAAS,MAAM,CACb,QAAS,IACT,SAAU,WACV,QACE,+EACN,CAAG,CACH"}